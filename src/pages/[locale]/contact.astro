---
import Layout from '../../layouts/Layout.astro';
import { locales, isValidLocale, type Locale } from '../../utils/i18n';
import { getEntry } from 'astro:content';

export function getStaticPaths() {
  return locales.map((locale) => ({ params: { locale } }));
}

const { locale } = Astro.params;

if (!isValidLocale(locale)) {
  return Astro.redirect('/en/contact');
}

const entry = await getEntry('pages', locale as Locale);
const t = entry.data;

---

<Layout title={t.contact.title}>
  <section class="pt-32 pb-20 bg-white min-h-screen">
    <div class="max-w-3xl mx-auto px-6 sm:px-8 lg:px-12">
      <div class="text-center mb-12">
        <h1 class="text-4xl sm:text-5xl font-bold text-gray-900 mb-4">
          {t.contact.title}
        </h1>
        <p class="text-lg text-gray-600 max-w-xl mx-auto">
          {t.contact.subtitle}
        </p>
      </div>

      <div class="bg-gradient-to-br from-violet-50 to-indigo-50 rounded-2xl p-8 sm:p-10 border border-violet-100">
        <div class="space-y-8">
          <!-- Email -->
          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm">
              <svg class="w-6 h-6 text-violet-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
              </svg>
            </div>
            <div>
              <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-1">{t.contact.emailLabel}</h3>
              <a href="mailto:contact@docnote.ch" class="text-xl font-medium text-gray-900 hover:text-violet-600 transition-colors">
                contact@docnote.ch
              </a>
            </div>
          </div>

          <!-- Phone -->
          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm">
              <svg class="w-6 h-6 text-violet-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
              </svg>
            </div>
            <div>
              <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-1">{t.contact.phoneLabel}</h3>
              <div id="phone-numbers" class="space-y-1">
                <div id="phone-ch" class="flex items-center gap-3">
                  <span class="text-sm text-gray-500">{t.contact.switzerland}:</span>
                  <a href="tel:+41762427299" class="text-lg font-medium text-gray-900 hover:text-violet-600 transition-colors">+41 76 242 72 99</a>
                </div>
                <div id="phone-fr" class="flex items-center gap-3">
                  <span class="text-sm text-gray-500">{t.contact.france}:</span>
                  <a href="tel:+33695288485" class="text-lg font-medium text-gray-900 hover:text-violet-600 transition-colors">+33 6 95 28 84 85</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>

<script>
  const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
  const phoneCH = document.getElementById('phone-ch');
  const phoneFR = document.getElementById('phone-fr');

  if (tz === 'Europe/Paris') {
    phoneCH?.remove();
  } else if (tz === 'Europe/Zurich' || tz === 'Europe/Busingen') {
    phoneFR?.remove();
  }
</script>
